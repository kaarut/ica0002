- name: Installing uwsgi-1
  ansible.builtin.apt:
    name: uwsgi
    state: present

- name: Installing uwsgi-2
  ansible.builtin.apt:
    name: uwsgi-plugin-python3
    state: present

- name: Copy ini file
  ansible.builtin.copy:
    src: ../files/agama.ini
    dest: /etc/uwsgi/apps-enabled/
    owner: agama
  notify: restart uwsgi

- name: Start service uWSGI , if not started
  ansible.builtin.service:
    name: uwsgi
    state: started
    
    
# - name: Restart after config change
#   ansible.builtin.template:
#     src: ./agama.ini
#     dest: /etc/uwsgi/apps-enabled/
#   notify:
#   -  Restart uwsgi

#   handlers:
#     - name: Restart uwsgi
#       ansible.builtin.service:
#         name: uwsgi
#         state: restarted


# - name: Install Flask python package
#   pip:
#     name: Flask-SQLAlchemy

# - name: Download the app
#   get_url:
#     url: https://raw.githubusercontent.com/hudolejev/agama/master/agama.py
#     dest: /opt/agama
    
# - name: Start service uWSGI , if not started
#   ansible.builtin.service:
#     name: uWSGI 
#     state: started